(function(a,b){if(typeof define==="function"&&define.amd){define(b)}else{a.Weixin=b()}}(window,function(){window.dj=window.dj||{};var h,i=window,g=i.wx,j=i.dj,b={},h,k=function(){var n=arguments,r=n[0],l=n.length,q;for(var m=1;m<l;m++){q=n[m];for(var p in q){r[p]=q[p]}}return r},e="i-weixin-share-success-callback".split(","),f={},a,d="trigger,cancel,fail,complete,success",c={debug:false,timestamp:+new Date(),jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"]};j.setPageData=function(l){e.forEach(function(m){if(m in l&&typeof l[m]==="function"){b[m]=b[m]||[];b[m].push(l[m]);delete l[m]}});b=k({},b,l)};a=j.getPageData=function(l){return l?b[l]:b};c.appid=j.getPageData("appID")||"wx89fd53302210a1d7";g.config(c);k(f,{resourceData:function(){var s=document.getElementsByTagName("meta"),m=s.length,p=0,l=h,o,r,n,q=/^og:([^\s]+)/i;if(l){return l}l={};for(;p<m;p++){r=s[p];n=r.getAttribute("property")||"";match=n.match(q);n&&match&&(l[match[1]]=r.getAttribute("content")||"")}o=l.url||location.href.replace("djshare=1","");o=o.indexOf("?")!=-1?o+"&xtjtr="+(+new Date()):o+"?xtjtr="+(+new Date());return h={imgUrl:l.image||"",img_width:b.imgWidth||"640",img_height:b.imgHeight||"640",link:o,desc:l.description||document.title||"",title:l.title||document.title||""}},init:function(){f.resourceData();f.handlePageSetting();"onMenuShareAppMessage,onMenuShareTimeline,onMenuShareQQ,onMenuShareWeibo".split(",").forEach(function(l){d.split(",").forEach(function(m){h[m]=f.wrapReport(m,l.replace("onMenu",""))});g[l](k({},h))})},handlePageSetting:function(){var l=document.getElementsByTagName("html")[0],m;f[l.getAttribute("hideMenu")==="true"||l.getAttribute("hideOptionMenu")||document.getElementById("hideMenu")?"hideOptionMenu":"showOptionMenu"]();"hideMenuItems,showMenuItems".split(",").forEach(function(n){(m=l.getAttribute(n))&&g[n]({menuList:m.split(","),success:function(){}})});"hideAllNonBaseMenuItem,showAllNonBaseMenuItem,hideOptionMenu,showOptionMenu".split(",").forEach(function(n){(m=l.getAttribute(n))&&typeof g[n]==="function"&&g[n]()})},wrapReport:function(l,m){return function(){f.report.apply(f,[l,m].concat([].slice.call(arguments)))}},report:function(m,o,n){var l=a("i-weixin-share-success-callback");if(m==="success"){f.shareSuccess&&f.shareSuccess(o);l&&l.length&&l.forEach(function(p){p(m,o,n)})}"trigger,cancel,fail,complete".split(",").forEach(function(p){p&&m===p&&(p=p.replace(/./,function(q){return q.toUpperCase()}));typeof f["my"+p]==="function"&&f["my"+p](m,o,n)})},myTrigger:function(l,n,m){},mySuccess:function(l,n,m){},myCancel:function(l,n,m){},myFail:function(l,n,m){},shareSuccess:function(l){var m=a("weixin-share-success");if(m&&m.url&&$&&$.ajax){m.data=m.data||{};l&&(m.data.shareType=l);$.ajax({url:m.url,type:m.ajaxType,data:m.data,dataType:"json",success:function(n){n&&n.result+""==="0"&&m.nextUrl&&(location.href=m.nextUrl.replace("{msg}",n.message));m.redirectUrl&&(location.href=n&&n.message?m.redirectUrl.replace("{msg}",n.message):m.redirectUrl)}})}}},g);g&&g.ready(f.init);return f}));
